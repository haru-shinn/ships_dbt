# メモ

```bash
# 初期化（コンテナ内で実行）
dbt init dbt_models

# profiles.ymlは他の場所から /app/dbt_models/ へ移動する。

# 接続テスト
dbt debug --target=dev

# コンパイルチェック
dbt compile --target=dev

# yamlファイル作成の自動化
# packages.ymlに dbt-labs/codegen を追加して、dbt deps
# dbt run でテーブルを作成した状態で下記を実行
dbt run-operation generate_model_yaml --args '{"model_names": ["stg_ports", "stg_routes", "stg_sections", "stg_route_sections", "stg_schedule"]}' --target=dev
dbt run-operation generate_model_yaml --args '{"model_names": ["stg_ships", "stg_room_class_master", "stg_ship_room_classes"]}' --target=dev
dbt run-operation generate_model_yaml --args '{"model_names": ["stg_reservations", "stg_reservation_details", "stg_inventory"]}' --target=dev

# dbt run (select利用)
dbt run --target=dev --select models/staging/route_operations
dbt run --target=dev --select models/staging/sales
dbt run --target=dev --select models/staging/ship_management
```

```bash
# コンテナ内からGitHubへPushできるように設定(失敗している。。)
# ホスト側の操作
# エージェント起動
eval "$(ssh-agent -s)"

# 鍵を登録
ssh-add ~/.ssh/id_rsa

ssh-add l

# devcontainer側の操作
ssh -T git@github.com
```

```bash
# ターミナルから直接開く場合
$ duckdb /app/.duckdb_database/ships_dbt.db

# 起動済みのDuckDB内で開く（または作成する）場合
D .open /app/.duckdb_database/ships_dbt.db

### duckdb cli 終了
.exit
```
